(()=>{"use strict";class e{static create(e,t){try{return localStorage.setItem(String(e),JSON.stringify(t)),!0}catch(e){console.log(e)}}static retrieve(e){let t=localStorage.getItem(String(e));return JSON.parse(t)}static retrieveAll(){let e=[];return Object.keys(localStorage).forEach((t=>{e.push(JSON.parse(localStorage.getItem(t)))})),e}static update(e,t,o){let d=this.retrieve(e);"todoList"===t?d[t].push(o):d[t]=o,localStorage.setItem(String(e),JSON.stringify(d))}static removeArrayItem(e,t,o){let d=this.retrieve(e);if("tags"===t||"todoList"===t){let i=d[t].indexOf(o);i>=0&&d[t].splice(i,1),localStorage.setItem(String(e),JSON.stringify(d))}}static deleteItem(e){localStorage.removeItem(String(e))}static deleteAll(e){localStorage.clear()}}class t{id=Math.random();constructor(e,t,o,d,i=[]){this.title=e,this.description=t,this.dueDate=o,this.tags=d,this.todoList=i}save(){let t={id:this.id,title:this.title,description:this.description,dueDate:this.dueDate,tags:this.tags,todoList:this.todoList};e.create(this.id,t)}}const o=function(){const o=document.querySelector("#dialog-form"),i=document.querySelector("#dialog-project-name"),l=document.querySelector("#dialog-project-description"),r=document.querySelector("#dialog-project-duedate"),a=document.querySelector("#dialog-project-tags"),c=document.querySelector("#dialog-edit-form"),n=document.querySelector("#dialog-edit-project-name"),s=document.querySelector("#dialog-edit-project-description"),u=document.querySelector("#dialog-edit-project-duedate"),p=document.querySelector("#dialog-edit-project-tags");return{createNewProject:function(c){c.preventDefault(),""!==i.value?(new t(i.value,l.value,r.value,a.value.split(" ")).save(),i.value="",l.value="",r.value="",a.value="",o.close(),d.displayProjectsMain(e.retrieveAll()),d.displayProjectsNav(e.retrieveAll())):i.reportValidity()},updateProject:function(t,o=!1){t.preventDefault();const i=e.retrieve(t.target.dataset.projectId);if(o){if(""===n.value)return void n.reportValidity();e.update(i.id,"title",n.value),e.update(i.id,"description",s.value),e.update(i.id,"dueDate",u.value),e.update(i.id,"tags",p.value.split(" ")),c.close(),d.displayProjectsMain(e.retrieveAll()),d.displayProjectsNav(e.retrieveAll())}else n.value=i.title,s.value=i.description,u.value=i.dueDate,p.value=i.tags.join(" ")},deleteProject:function(t){e.deleteItem(t.target.dataset.projectId),d.displayProjectsMain(e.retrieveAll()),d.displayProjectsNav(e.retrieveAll())},createNewTodo:function(t){if("Enter"===t.key){let o=t.target.id.split("-")[2],i="todoList",l=t.target.value;e.update(o,i,l),d.displayProjectsMain(e.retrieveAll())}},deleteTodoItem:function(t){t.target.style.textDecoration="line-through",e.removeArrayItem(t.target.id.split("-")[2],"todoList",t.target.dataset.value)},viewProject:function(t){let o=e.retrieveAll().filter((e=>String(e.id)===t.target.dataset.projectId));d.displayProjectsMain(o)}}}(),d={displayProjectsNav:function(e){const t=document.querySelector(".project-list");t.replaceChildren();const d=document.createElement("ul");if(0!==e.length){for(let t of e){const e=document.createElement("li");e.textContent=t.title,e.dataset.projectId=t.id,e.classList.add("project"),e.addEventListener("click",(e=>{o.viewProject(e)})),d.appendChild(e)}t.appendChild(d)}else projectList.textContent="No projects to display"},displayProjectsMain:function(e){const t=document.querySelector(".main");if(t.replaceChildren(),0!==e.length)for(let d of e){const e=document.createElement("section");e.classList.add("section"),e.dataset.projectId=d.id;const i=document.createElement("div");i.textContent=d.title,i.classList.add("project-title"),e.appendChild(i);const l=document.createElement("div");""===d.description&&(d.description="No description given",l.style.fontStyle="italic"),l.textContent=d.description,l.classList.add("project-description"),e.appendChild(l);const r=document.createElement("div");r.textContent=`Due Date: ${d.dueDate}`,d.dueDate<=(new Date).toJSON().slice(0,10)&&(r.style.color="#9c0d0d"),r.classList.add("project-due-date"),e.appendChild(r);const a=document.createElement("div");d.tags=d.tags.map((e=>`#${e}`)),a.textContent=`Tags: ${d.tags.join(", ")}`,a.classList.add("project-tags"),e.appendChild(a);const c=document.createElement("div");c.classList.add("project-todo-list"),c.textContent="Todo List:";const n=document.createElement("ul");for(let[e,t]of d.todoList.entries()){const i=document.createElement("li");i.id=`todo-${e}-${d.id}`,i.dataset.value=t,i.textContent=t,i.addEventListener("click",o.deleteTodoItem),n.appendChild(i)}c.appendChild(n),e.appendChild(c);const s=document.createElement("div"),u=document.createElement("label"),p=document.createElement("input");p.type="text",s.classList.add("add-todo"),u.htmlFor=`add-todo-${d.id}`,p.id=`add-todo-${d.id}`,p.name=`add-todo-${d.id}`,p.placeholder="Enter new todo item",p.addEventListener("keydown",o.createNewTodo),s.appendChild(u),s.appendChild(p),e.appendChild(s);const m=document.createElement("button");m.classList.add("edit-btn"),m.textContent="Edit Project",m.type="button",m.dataset.projectId=d.id,m.addEventListener("click",(e=>{const t=document.querySelector("#dialog-edit-form"),i=document.querySelector("#edit-project-btn");t.showModal(),i.dataset.projectId=d.id,o.updateProject(e,!1)})),e.appendChild(m);const v=document.createElement("button");v.classList.add("delete-btn"),v.textContent="Delete Project",v.type="button",v.dataset.projectId=d.id,v.addEventListener("click",(e=>{o.deleteProject(e)})),e.appendChild(v),t.appendChild(e)}else t.textContent="No projects to display"}},i=document.querySelector("#open-dialog-button"),l=document.querySelector("#dialog-form"),r=document.querySelector("#add-project-btn"),a=document.querySelector("#edit-project-btn"),c=document.querySelector("#view-today"),n=document.querySelector("#view-upcoming"),s=document.querySelector("#view-all");d.displayProjectsNav(e.retrieveAll()),d.displayProjectsMain(e.retrieveAll()),i.addEventListener("click",(()=>{l.showModal()})),r.addEventListener("click",(e=>o.createNewProject(e))),a.addEventListener("click",(e=>o.updateProject(e,!0))),s.addEventListener("click",(t=>{t.preventDefault();const o=e.retrieveAll();d.displayProjectsMain(o)})),c.addEventListener("click",(t=>{t.preventDefault();const o=e.retrieveAll().filter((e=>e.dueDate<=(new Date).toJSON().slice(0,10)));d.displayProjectsMain(o)})),n.addEventListener("click",(t=>{t.preventDefault();const o=e.retrieveAll().filter((e=>e.dueDate>(new Date).toJSON().slice(0,10)));d.displayProjectsMain(o)}));const u=document.querySelector(".mobile-nav"),p=document.querySelector(".nav"),m=document.querySelectorAll(".mobile-hidden"),v=document.querySelectorAll(".mobile-margin-bottom");u.addEventListener("click",(()=>{const e=window.getComputedStyle(p);m.forEach((e=>{e.classList.toggle("mobile-hidden")})),v.forEach((e=>{e.style.marginBottom=""===e.style.marginBottom?"10px":""})),i.style.marginBottom=""===i.style.marginBottom?"20px":"",p.style.display="flex"===e.getPropertyValue("display")?"block":"flex"}))})();